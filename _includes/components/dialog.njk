{# Nested Components ------------------------------------------------------------------------------------------------------------------- #}

{% from "components/section.njk" import section %}
{% from "components/container.njk" import container %}
{% from "components/button.njk" import button %}
{% from "snippets/loopAttrs.njk" import loopAttrs %}

{# Macro ------------------------------------------------------------------------------------------------------------------------------- #}

{% macro dialog(props={}, attrs={}) %}

{# Values ----------- #}

{% set dialogStyles = "backdrop:bg-neutral/35 bg-transparent mt-section mb-auto" %}
{% set panelStyles = "bg-surface shadow-zine border border-neutral-light" %}

{# ------------------------------------------------------------------------------------------------------------------------------------- #}

<div
    data-dialog
    x-data="{close() {$refs.dialog.close()}}"
    {{ loopAttrs(attrs) }}
    class="{{ attrs.class }}">
    {{ button(props=props.triggerProps, attrs={"@click": "$refs.dialog.showModal()", class:"w-full"}) }}
    <template x-teleport="body">
        <dialog
        closedby={% if props.closedBy %}{{ props.closedBy }}{% else %}"any"{% endif %}
        x-ref="dialog"
        class="{{ attrs.class }} {{ dialogStyles }} @container w-full flex overflow-x-hidden overflow-y-auto open:visible invisible flex-col items-center mx-auto inset-0 p-0">
            {% call container({size: "narrow"},{class:panelStyles + " pointer-events-auto"}) %}
                {{ caller() | safe }}
            {% endcall %}
        </dialog>
    </template>
</div>

{% endmacro %}

{# Component Documentation ------------------------------------------------------------------------------------------------------------- #}

{% set dialogMeta = {
    args: '{% call dialog(
    props={
        closedBy: "any" | "none",
        triggerProps: {}
    },
    attrs={}
) %}
{% endcall %}',
description: "
- `props.triggerProps` is the props object for the `button` component that opens the `dialog`.
-  Give an element inside the `dialog` the `close()` event to make it close the `dialog`.
- `props.closedBy: 'none'` makes it so the escape key won't close the `dialog`.
"
} %}
