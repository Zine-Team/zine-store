{% from "components/button.njk" import button %}

{% macro siteNav() %}
    <nav class="zine-store-container shrink-0 flex items-baseline justify-between py-nav">
        <span class="flex justify-self-start gap-16">
            {{button(label="Home", href="/", size="lg", type="link")}}
            {% if page.url == "/" %}
                {{button(label="Most recent zines", href="#recentZines", size="lg", type="link", class="hidden lg:flex")}}
                {{button(label="All zines", href="#allZines", size="lg", type="link", class="hidden lg:flex")}}
            {% endif %}
        </span>
        <span class="flex justify-self-end">
            {% if page.url == "/" %}
                {# {% include "components/submissionDialog.njk" %} #}
                {{button(label="Submit a zine", size="lg", type="button", href=global.submissionHref)}}
            {% else %}
                <div
                    x-data="{
                    input: '{{ global.siteDomain }}/{{ page.url }}',
                        open: false,
                        toggle() {
                            if (this.open) {
                                return this.close()
                            }
                            this.$refs.button.focus()
                            this.open = true
                        },
                        close(focusAfter) {
                            if (! this.open) return
                            this.open = false
                            focusAfter && focusAfter.focus()
                        }
                    }"
                    x-on:keydown.escape.prevent.stop="close($refs.button)"
                    x-on:focusin.window="! $refs.panel.contains($event.target) && close()"
                    class="relative"
                >
                    {{button(label="Share", type="button", size="lg", attrs={
                        "x-ref": "button",
                        "@click": "toggle()",
                        ":aria-expanded": "open",
                        ":aria-controls": "$id('dropdown-button')",
                        "type": "button"
                    })}}
                    <div
                        x-ref="panel"
                        x-show="open"
                        x-on:click.outside="close($refs.button)"
                        x-cloak
                        class="absolute right-0 min-w-max shadow-page mt-2 z-10 bg-white-smoke border border-grey px-5 py-3 gap-3 outline-none flex flex-col items-start">
                        {{button(label="Download PDF", href=pdf, type="link", attrs={download: null})}}
                        {{button(label="Copy link", type="link", attrs={"x-clipboard": "input"})}}
                    </div>
                </div>
            {% endif %}
        </span>
    </nav>
{% endmacro %}
