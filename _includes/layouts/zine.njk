---
layout: base
---
{% from "components/button.njk" import button %}
{% from "components/siteNav.njk" import siteNav with context %}
{% from "components/dropdown.njk" import dropdown %}
{% from "components/copyToClipboard.njk" import copyToClipboard %}
{% from "components/container.njk" import container %}

{% set pdfUrl = global.imagesFolder + "/" + page.fileSlug +"/" + pdf %}

{% set embed %}
    <iframe name="{{title | lower | replace(' ', '-')}}" width="100%" height="100%" src="{{global.siteDomain}}{{page.url}}?embed=true" allow="clipboard-write" marginwidth="0" marginheight="0" style=" border: 1px solid darkGray; max-width: 900px; max-height: 800px; aspect-ratio: 1 / 1.8;"></iframe>
{% endset %}
    <div x-data="{
        params: new URLSearchParams(window.location.search),
        isEmbed () {
            const value = this.params.get('embed')
            return value ? value : false
        }
    }"
        class="flex flex-col w-full grow">
        {% call siteNav({}, {
            "x-show": "!isEmbed()"
        }) %}
            {% call dropdown(
                props={position:["bottom", "right"]},
                triggerProps={label: "Share", type: "button", size:"base"})
            %}
                <li>{{ button({label:"Download PDF", type:"link", size:"base"}, {href:pdfUrl, download: null}) }}</li>
                {% call copyToClipboard({
                    input: global.siteDomain + page.url ,
                    toastMessage: "URL copied to clipboard!"
                }) %}
                    <li>{{ button({label:"Copy link", type:"link", size:"base"}, {@click: "copy"}) }}</li>
                {% endcall %}
                {% call copyToClipboard({
                    input: embed | dump | trim | unquote,
                    toastMessage: "Embed code copied to clipboard!"
                }) %}
                    <li>{{ button({label:"Copy embed code", type:"link", size:"base"}, {@click: "copy"}) }}</li>
                {% endcall %}
            {% endcall %}
        {% endcall %}
        <main class="relative flex flex-col items-center w-full grow">
            <div class="sr-only">
                <h1>{{ title }}</h1>
            </div>
            <div class="flex flex-col items-center w-full grow">
                {% call container({},{class:"grow"}) %}
                <div data-zine-part="navigator" class="flex flex-col lg:flex-row lg:justify-center lg:gap-10 xl:gap-20 grow {% if aspect !== "5.5 / 4.25" %} pb-section-title{% endif %}">
                    {{ button(props={icon:"←", type: "button", size:"base"}, attrs={class:"h-[max(25dvh,_72px)] hidden lg:block self-center", "data-action": "prev-wide"}) }}
                    <div data-zine-part="root" class="flex flex-col items-center justify-center col-start-1 col-end-3 grow lg:grow-0 perspective-zine lg:col-auto">
                        <div data-zine-part="outer" class="relative inset-0 flex items-center w-full py-2 md:justify-center">
                            <div data-zine-part="spread" style="--aspect-zine: {{ aspect }}" class="relative grid grid-cols-2 justify-self-start shrink-0 lg:justify-self-center aspect-zine md:w-full {% if aspect === "5.5 / 4.25" %}max-w-3xl{% endif %} pointer-events-none perspective-zine front-cover">
                                {% for pg in pages %}
                                    <div data-zine-part="page" class="relative row-start-1 row-end-2 border border-neutral-lighter not-first:odd:border-l-0 not-last:even:border-r-0 backface-hidden even:col-start-1 odd:col-start-2 even:origin-right odd:origin-left">
                                        <img src="{{ global.imagesFolder }}/{{ page.fileSlug }}/{{ pg.image }}.jpg" alt="{{ pg.altText }}">
                                    </div>
                                {% endfor %}
                            </div>
                            <button data-action="prev-narrow" aria-label="Previous page" class="absolute inset-y-0 left-0 w-1/3 md:hidden"></button>
                            <button data-action="next-narrow" aria-label="Next page" class="absolute inset-y-0 right-0 w-1/3 md:hidden"></button>
                        </div>
                    </div>
                    {{ button(props={icon: "→", size: "base", type: "button" }, attrs={class: "h-[max(25dvh,_72px)] hidden lg:block self-center", "data-action": "next-wide"}) }}
                </div>
                {% endcall %}
            </div>
            <div class="flex lg:hidden gap-site-inline py-nav border-neutral-lighter border-t border-dotted px-site-inline w-[100vw] bg-surface sticky bottom-0">
                {{ button(props={icon: "←", type: "button", size:"base"}, attrs={class: "grow hidden md:block min-h-14", "data-action": "prev-wide"}) }}
                {{ button(props={icon: "→", type: "button", size:"base"}, attrs={class: "grow hidden md:block min-h-14", "data-action": "next-wide"}) }}
                {{ button(props={icon: "←", type: "button", size:"base"}, attrs={class: "grow md:hidden min-h-14", "data-action": "prev-narrow"}) }}
                {{ button(props={icon: "→", type: "button", size:"base"}, attrs={class: "grow md:hidden min-h-14", "data-action": "next-narrow"}) }}
            </div>
        </main>
    </div>
<script defer src="/bundle.js" type="module"></script>
